<!DOCTYPE html><html lang="en"><head><title>routes</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="routes"><meta name="groc-project-path" content="src/routes.coffee"><meta name="groc-github-url" content="https://github.com/tectual/hapi-notification-server"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/tectual/hapi-notification-server/blob/master/src/routes.coffee">src/routes.coffee</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper">Joi = <span class="hljs-built_in">require</span> <span class="hljs-string">'joi'</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">(server, options)</span> -&gt;</span>

  Users = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./handlers/users'</span>) server, options
  Messages = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./handlers/messages'</span>) server, options
  
  [
    {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>
      <span class="hljs-attribute">path</span>: <span class="hljs-string">"/users"</span>
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">handler</span>: Users.create
        <span class="hljs-attribute">description</span>: <span class="hljs-string">'Store user with notification id'</span>
        <span class="hljs-attribute">tags</span>: [<span class="hljs-string">'user'</span>, <span class="hljs-string">'notification'</span>]
        <span class="hljs-attribute">validate</span>: {
          <span class="hljs-attribute">payload</span>: {
            <span class="hljs-attribute">user_key</span>: Joi.string().required()
            <span class="hljs-attribute">nid</span>: Joi.string().required()
            <span class="hljs-attribute">device</span>: Joi.string().required().valid(<span class="hljs-string">'iphone'</span>,<span class="hljs-string">'android'</span>)
          }
        }
      }
    }
    {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'DELETE'</span>
      <span class="hljs-attribute">path</span>: <span class="hljs-string">"/users/{id}"</span>
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">handler</span>: Users.remove
        <span class="hljs-attribute">description</span>: <span class="hljs-string">"Clear user's notification id"</span>
        <span class="hljs-attribute">tags</span>: [<span class="hljs-string">'user'</span>, <span class="hljs-string">'notification'</span>]
      }
    }
    {
      <span class="hljs-attribute">method</span>: <span class="hljs-string">'POST'</span>
      <span class="hljs-attribute">path</span>: <span class="hljs-string">"/messages"</span>
      <span class="hljs-attribute">config</span>: {
        <span class="hljs-attribute">handler</span>: Messages.post
        <span class="hljs-attribute">description</span>: <span class="hljs-string">'Send a notification to users by user_key'</span>
        <span class="hljs-attribute">tags</span>: [<span class="hljs-string">'message'</span>, <span class="hljs-string">'notification'</span>]
        <span class="hljs-attribute">validate</span>: {
          <span class="hljs-attribute">payload</span>: {
            <span class="hljs-attribute">user_keys</span>: Joi.array().required()
            <span class="hljs-attribute">template</span>: Joi.string().required()
            <span class="hljs-attribute">data</span>: Joi.object().required()
          }
        }
      }
    }
 
  ]</div></div></div></div></body></html>